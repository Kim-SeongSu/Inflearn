# 04. HTTP - Method
### 🔷 **API URI 설계**
ㅤㅤ✔ **잘못된 설계** <br>
```java
• 회원 목록 조회 /read-member-list
• 회원 조회 /read-member-by-id
• 회원 등록 /create-member
• 회원 수정 /update-member
• 회원 삭제 /delete-member
```

ㅤㅤㅤ🔹 **`회원`이라는 개념 자체가 리소스**이므로, 리소스를 식별할 수 있도록 URI계층 구조로 표현해야 한다. <br>
ㅤㅤㅤㅤㅤ- **URI는 리소스만 식별한다!** <br>

ㅤㅤ✔ **문제점** <br>
```java
• 회원 목록 조회 /members
• 회원 조회 /members/{id} -> 어떻게 구분하지?
• 회원 등록 /members/{id} -> 어떻게 구분하지?
• 회원 수정 /members/{id} -> 어떻게 구분하지?
• 회원 삭제 /members/{id} -> 어떻게 구분하지?
```

ㅤㅤㅤ🔹 **`리소스`와 해당 리소스를 대상으로 하는 `행위`을 분리**해야 한다. <br>
ㅤㅤㅤㅤㅤ- 리소스: `회원` <br>
ㅤㅤㅤㅤㅤ- 행위: `조회`, `등록`, `삭제`, `변경` <br>
ㅤㅤㅤㅤㅤㅤ✅ **행위(메서드)는 HTTP 메서드를 통해 구분!** <br><br><br><br>

### 🔷 **HTTP 메서드**
ㅤㅤ✔ **주요 메서드** <br>
ㅤㅤㅤ🔹 **`GET`**: 리소스 **조회** <br>
ㅤㅤㅤㅤㅤ- 서버에 전달하고 싶은 데이터는 **query**(쿼리 파라미터, 쿼리 스트링)를 통해서 전달 <br>
```http
# GET 예시 1
GET /search?q=hello&hl=ko HTTP/1.1     <!-- `/search?q=hello&hl=ko` 부분을 조회 요청 -->
Host: www.google.com


# GET 예시 2
GET /members/100 HTTP/1.1              <!-- `/members/100` 유저 조회 요청 -->
Host: localhost:8080

>> 예시 2 응답 메시지
HTTP/1.1 200 OK
Content-Type: application/json
Content-Length: 34
{
 "username": "young",
 "age": 20
}
```
<br>

ㅤㅤㅤ🔹 **`POST`**: **요청 데이터 처리** (주로 등록에 사용)<br>
ㅤㅤㅤㅤㅤ- **메시지 바디**를 통해 서버로 요청 데이터 전달 <br>
ㅤㅤㅤㅤㅤㅤ**▫️** 기능1. 새 리소스 생성(등록) <br>
ㅤㅤㅤㅤㅤㅤㅤㅤex) 서버가 아직 식별하지 않은 새 리소스 생성 <br>
ㅤㅤㅤㅤㅤㅤ**▫️** 기능2. 요청 데이터 처리 <br>
ㅤㅤㅤㅤㅤㅤㅤㅤex) 단순히 데이터를 생성하거나, 변경하는 것을 넘어서 프로세스를 처리해야 하는 경우 <br>
ㅤㅤㅤㅤㅤㅤㅤㅤex) POST의 결과로 새로운 리소스가 생성되지 않을 수도 있음 `POST /orders/{orderId}/start-delivery`[^1] <br>
ㅤㅤㅤㅤㅤㅤ**▫️** 기능3. 다른 메서드로 처리하기 애매한 경우 POST 사용 <br>
ㅤㅤㅤㅤㅤㅤㅤㅤex) JSON으로 조회 데이터를 넘겨야 하는데, GET 메서드를 사용하기 어려운 경우 <br>

[^1]: `start-delivery`처럼 명사(리소스)가 아닌 동사(행위)로 된 URI를 **컨트롤 URI**라고 한다.

```http
# POST 예시
POST /members HTTP/1.1                <!-- 다음과 같은 메시지 바디를 줄테니 처리해달라 요청 -->
Content-Type: application/json
{
 "username": "young",
 "age": 20
}

>> POST 예시 응답 메시지
HTTP/1.1 201 Created                   <!-- 201로 보낼때는 Location 정보(신규 자원이 생성된 경로)가 함께 보내진다 -->
Content-Type: application/json
Content-Length: 34
Location: /members/100 
{
 "username": "young",
 "age": 20
}
```
<br>

ㅤㅤㅤ🔹 **`PUT`**: 리소스가 있으면 (완전히) 대체, 리소스가 없으면 생성 (=**덮어쓰기**)<br>
ㅤㅤㅤㅤㅤ- **클라이언트가 리소스 위치를 알고 URI를 지정** <br>

```http
# PUT 예시
PUT /members/100 HTTP/1.1            <!-- 리소스의 위치(/members/100)를 클라이언트가 알고 있는 점이 POST와의 차이점 -->
Content-Type: application/json
{
 "age": 50                            <!-- 기존의 "username": "young", "age": 20 가  "age": 50 로 완전히 대체 (username 필드 사라짐) -->
}
```
<br>

ㅤㅤㅤ🔹 **`PATCH`**: 리소스 **부분 변경** <br>

```http
# PATCH 예시
PATCH /members/100 HTTP/1.1         
Content-Type: application/json
{
 "age": 50                            <!-- 기존의 "username": "young", "age": 20 가  "username": "young", "age": 50 로 부분 변경 -->
}
```
<br>

ㅤㅤㅤ🔹 **`DELETE`**: 리소스 **삭제** <br>

```http
# DELETE 예시
DELETE /members/100 HTTP/1.1        <!-- /members/100 리소스 제거 -->
Host: localhost:8080
```
<br>


ㅤㅤ✔ **기타 메서드** <br>
ㅤㅤㅤ🔹 **`HEAD`**: `GET`과 동일하지만 메시지 부분을 제외하고, **상태 줄과 헤더만 반환** <br>
ㅤㅤㅤ🔹 **`OPTIONS`**: 대상 리소스에 대한 통신 가능 옵션(메서드)을 설명(주로 CORS에서 사용) <br>
ㅤㅤㅤ🔹 **`CONNECT`**: 대상 리소스로 식별되는 서버에 대한 터널을 설정 <br>
ㅤㅤㅤ🔹 **`TRACE`**: 대상 리소스에 대한 경로를 따라 메시지 루프백 테스트를 수행 <br><br><br><br>


### 🔷 **HTTP 메서드의 속성**
ㅤㅤ✔ **안전(Safe Methods): 호출해도 리소스를 변경하지 않는 것** <br>
ㅤㅤ✔ **멱등(Idempotent Methods): 한 번 호출하든 두 번 호출하든 100번 호출하든 결과가 똑같아야 한다. `f(f(x)) = f(x)`** <br>
ㅤㅤㅤ❗**POST는 두 번 호출하면 같은 결제가 중복해서 발생할 수 있기 때문에 멱등이 아니다** <br>
ㅤㅤㅤ🔹 자동 복구 메커니즘으로 활용 <br>
ㅤㅤㅤ🔹 멱등은 외부 요인으로 중간에 리소스가 변경되는 것 까지는 고려하지는 않는다. <br>
ㅤㅤ✔ **캐시가능(Cacheable Methods): 응답 결과 리소스를 캐시해서 사용해도 되는 지 여부** <br>
ㅤㅤㅤ🔹 GET, HEAD, POST, PATCH 캐시가능 (실제로는 GET, HEAD 정도만 캐시로 사용) <br>

<div align="center">
  <img width="80%" src="https://github.com/user-attachments/assets/bc533956-503b-46a4-b11e-cb73607d903f">
</div> <br><br><br><br>


### 🔷 **HTTP 메서드 활용**
ㅤㅤ✔ **클라이언트에서 서버로 데이터 전송** <br>
ㅤㅤ**1️⃣ 쿼리 파라미터를 통한 데이터 전송** <br>
ㅤㅤㅤㅤ🔹 **GET** <br>
ㅤㅤㅤㅤ🔹 **주로 정렬 필터(검색어)** <br>
ㅤㅤ**2️⃣ 메시지 바디를 통한 데이터 전송** <br>
ㅤㅤㅤㅤ🔹 **POST, PUT, PATCH** <br>
ㅤㅤㅤㅤ🔹 **회원 가입, 상품 주문, 리소스 등록, 리소스 변경** <br>

ㅤㅤ✔ **HTTP API 설계 예시** <br>


<!--
공백문자: "ㅤ" or &nbsp; →
### 🔷 ****
>ㅤ✅ **** <br>
ㅤㅤ:  <br>
ㅤㅤㅤex) <br>
ㅤㅤ✔ **** <br>
ㅤㅤㅤ🔹 **** <br>
ㅤㅤㅤㅤㅤ- **** <br>
ㅤㅤㅤㅤㅤㅤex) <br>
➡️
ㅤㅤ❗ <br>
ㅤㅤ❓ <br>
ㅤㅤ✅ <br>
ㅤㅤㅤㅤ**▪️** <br>
ㅤㅤㅤㅤ**▫️** <br>
ㅤㅤ**1️⃣** <br>
ㅤㅤ**2️⃣** <br>
ㅤㅤ**3️⃣** <br>
ㅤㅤ**4️⃣** <br>
ㅤㅤ**5️⃣** <br>
ㅤㅤ**🤔** <br>
> [!NOTE]  
> [!TIP]
> [!IMPORTANT]  
> [!WARNING]  
> [!CAUTION]


**💡 예시**
```JAVA

```


<details><summary>💡예시 코드</summary>

```JAVA

```
</details>

<br><div align="center">
  <img width="70%" src="">
</div> <br><br>


<div align="center">
|****|****|
|:--:|:--:|
|||
</div> 

[^1]
-->
